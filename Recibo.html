<!doctype html>
<html lang="es" data-bs-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Recibo</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

  <style>
    body{
      background:#0b0f14;
      color: rgba(233,238,245,.92);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }

    .wrap{ max-width: 980px; }

    .btn-soft{
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(233,238,245,.92);
    }
    .btn-soft:hover{ filter: brightness(1.08); }

    .muted{ color: rgba(233,238,245,.70); }
    .mini{ font-size: .92rem; }

    /* ====== Ticket preview container (white) ====== */
    #pdfArea{
      width: 302px;              
      background:#fff;
      color:#111;
      border-radius: 16px;
      padding: 14px 14px 12px;
      margin: 0 auto;
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
    }

    /* header */
    .t-center{ text-align:center; }
    .t-hr{ border-top: 1px dashed rgba(0,0,0,.35); margin: 10px 0; }

    .t-row{ display:flex; justify-content:space-between; gap:10px; }
    .t-muted{ color:#666; font-size: 12px; }
    .t-small{ font-size: 12px; }
    .t-bold{ font-weight: 800; }
    .t-title{ font-weight: 900; font-size: 16px; letter-spacing: .2px; }

    .logo{
      width: 54px; height: 54px;
      object-fit: cover;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.10);
      display:none;
      margin: 0 auto 8px;
    }

    /* items */
    .items{
      margin-top: 6px;
      font-size: 12px;
    }
    .item{
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding: 6px 0;
      border-bottom: 1px dotted rgba(0,0,0,.18);
    }
    .item:last-child{ border-bottom: none; }

    .item-name{
      flex: 1;
      min-width: 0;
    }
    .item-name .n{ font-weight: 700; line-height: 1.12; }
    .item-name .s{ font-size: 11px; color:#555; margin-top: 2px; }

    .item-qty{ width: 40px; text-align:right; color:#333; }
    .item-total{ width: 84px; text-align:right; font-weight: 800; }

    /* totals */
    .totals{
      margin-top: 8px;
      font-size: 12px;
    }
    .totals .t-row{ margin: 4px 0; }
    .grand{
      font-size: 14px;
      font-weight: 900;
      margin-top: 6px;
    }

    /* QR */
    .qrbox{
      margin-top: 10px;
      display: grid;
      place-items: center;
      gap: 6px;
    }
    #rxQRCanvas{
      width: 170px;
      height: 170px;
      background:#fff;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.10);
      padding: 8px;
    }

    .foot{
      margin-top: 8px;
      text-align:center;
      font-size: 11px;
      color:#555;
    }

    /* On screen controls look */
    .cardx{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      padding: 14px;
    }
  </style>
</head>

<body>
  <main class="container py-4">
    <div class="wrap mx-auto">

      <div id="rxErr" class="alert alert-danger d-none"></div>

      <!-- Controles -->
      <div class="cardx mb-3">
        <div class="d-flex flex-wrap gap-2 justify-content-between align-items-center">
          <div class="muted mini">
            <i class="bi bi-shield-check me-1"></i>
            Ticket digital seguro (token)
          </div>
          <div class="d-flex gap-2">
            <button id="btnPdf" class="btn btn-primary">
              <i class="bi bi-filetype-pdf me-1"></i> Descargar PDF
            </button>
            <button id="btnCopy" class="btn btn-soft">
              <i class="bi bi-clipboard me-1"></i> Copiar link
            </button>
          </div>
        </div>
      </div>

      <!-- Ticket area (white) -->
      <section id="pdfArea" aria-label="Ticket">
        <img id="rxLogo" class="logo" alt="Logo del negocio" />

        <div class="t-center">
          <div class="t-title" id="rxBizName">â€”</div>
          <div class="t-muted" id="rxBizMeta">â€”</div>
        </div>

        <div class="t-hr"></div>

        <div class="t-small">
          <div class="t-row"><span class="t-muted">Fecha</span><span id="rxDate">â€”</span></div>
          <div class="t-row"><span class="t-muted">Folio</span><span class="t-bold" id="rxFolio">â€”</span></div>
          <div class="t-row"><span class="t-muted">Pago</span><span id="rxPayMethod">â€”</span></div>
          <div class="t-row"><span class="t-muted">Ref</span><span id="rxPayRef">â€”</span></div>
        </div>

        <div class="t-hr"></div>

        <div class="t-row t-small" style="margin-bottom:6px;">
          <span class="t-bold">Items</span>
          <span class="t-muted" id="rxItemsCount">0</span>
        </div>

        <div id="rxItems" class="items"></div>

        <div class="t-hr"></div>

        <div class="totals">
          <div class="t-row"><span class="t-muted">Subtotal</span><span id="rxSubtotal">$0.00</span></div>
          <div class="t-row"><span class="t-muted">Descuento</span><span id="rxDiscount">$0.00</span></div>
          <div class="t-row"><span class="t-muted">Impuestos</span><span id="rxTax">$0.00</span></div>
          <div class="t-row grand"><span>Total</span><span id="rxTotal">$0.00</span></div>
        </div>

        <div class="t-hr"></div>

        <div class="t-small">
          <div class="t-muted">Nota</div>
          <div id="rxNote" style="white-space:pre-wrap;">â€”</div>
        </div>

        <!-- QR dentro del ticket -->
        <div class="qrbox">
          <canvas id="rxQRCanvas" width="170" height="170"></canvas>
          <div class="t-muted t-center" style="font-size:11px;">
            Escanea para ver/guardar este recibo
          </div>
        </div>

        <div class="foot" id="rxThanks">
          Gracias por tu compra ðŸ’™
        </div>
      </section>

    </div>
  </main>

  <!-- libs -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <!-- QR lib (simple global) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>

  <!-- tu JS -->
  <script type="module" src="JavaScript/recibo.js"></script>
</body>
</html>
